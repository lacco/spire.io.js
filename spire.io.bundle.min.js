<<<<<<< HEAD
var require=function(a,b){var c=require.resolve(a,b||"/"),d=require.modules[c];if(!d)throw new Error("Failed to resolve module "+a+", tried "+c);var e=d._cached?d._cached:d();return e};require.paths=[],require.modules={},require.extensions=[".js",".coffee"],require._core={assert:!0,events:!0,fs:!0,path:!0,vm:!0},require.resolve=function(){return function(a,b){function g(a){if(require.modules[a])return a;for(var b=0;b<require.extensions.length;b++){var c=require.extensions[b];if(require.modules[a+c])return a+c}}function h(a){a=a.replace(/\/+$/,"");var b=a+"/package.json";if(require.modules[b]){var d=require.modules[b](),e=d.browserify;if(typeof e=="object"&&e.main){var f=g(c.resolve(a,e.main));if(f)return f}else if(typeof e=="string"){var f=g(c.resolve(a,e));if(f)return f}else if(d.main){var f=g(c.resolve(a,d.main));if(f)return f}}return g(a+"/index")}function i(a,b){var c=j(b);for(var d=0;d<c.length;d++){var e=c[d],f=g(e+"/"+a);if(f)return f;var i=h(e+"/"+a);if(i)return i}var f=g(a);if(f)return f}function j(a){var b;a==="/"?b=[""]:b=c.normalize(a).split("/");var d=[];for(var e=b.length-1;e>=0;e--){if(b[e]==="node_modules")continue;var f=b.slice(0,e+1).join("/")+"/node_modules";d.push(f)}return d}b||(b="/");if(require._core[a])return a;var c=require.modules.path(),d=b||".";if(a.match(/^(?:\.\.?\/|\/)/)){var e=g(c.resolve(d,a))||h(c.resolve(d,a));if(e)return e}var f=i(a,d);if(f)return f;throw new Error("Cannot find module '"+a+"'")}}(),require.alias=function(a,b){var c=require.modules.path(),d=null;try{d=require.resolve(a+"/package.json","/")}catch(e){d=require.resolve(a,"/")}var f=c.dirname(d),g=(Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b})(require.modules);for(var h=0;h<g.length;h++){var i=g[h];if(i.slice(0,f.length+1)===f+"/"){var j=i.slice(f.length);require.modules[b+j]=require.modules[f+j]}else i===f&&(require.modules[b]=require.modules[f])}},require.define=function(a,b){var c=require._core[a]?"":require.modules.path().dirname(a),d=function(a){return require(a,c)};d.resolve=function(a){return require.resolve(a,c)},d.modules=require.modules,d.define=require.define;var e={exports:{}};require.modules[a]=function(){return require.modules[a]._cached=e.exports,b.call(e.exports,d,e,e.exports,c,a),require.modules[a]._cached=e.exports,e.exports}},typeof process=="undefined"&&(process={}),process.nextTick||(process.nextTick=function(){var a=[],b=typeof window!="undefined"&&window.postMessage&&window.addEventListener;return b&&window.addEventListener("message",function(b){if(b.source===window&&b.data==="browserify-tick"){b.stopPropagation();if(a.length>0){var c=a.shift();c()}}},!0),function(c){b?(a.push(c),window.postMessage("browserify-tick","*")):setTimeout(c,0)}}()),process.title||(process.title="browser"),process.binding||(process.binding=function(a){if(a==="evals")return require("vm");throw new Error("No such module")}),process.cwd||(process.cwd=function(){return"."}),require.define("path",function(a,b,c,d,e){function f(a,b){var c=[];for(var d=0;d<a.length;d++)b(a[d],d,a)&&c.push(a[d]);return c}function g(a,b){var c=0;for(var d=a.length;d>=0;d--){var e=a[d];e=="."?a.splice(d,1):e===".."?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c--;c)a.unshift("..");return a}var h=/^(.+\/(?!$)|\/)?((?:.+?)?(\.[^.]*)?)$/;c.resolve=function(){var a="",b=!1;for(var c=arguments.length;c>=-1&&!b;c--){var d=c>=0?arguments[c]:process.cwd();if(typeof d!="string"||!d)continue;a=d+"/"+a,b=d.charAt(0)==="/"}return a=g(f(a.split("/"),function(a){return!!a}),!b).join("/"),(b?"/":"")+a||"."},c.normalize=function(a){var b=a.charAt(0)==="/",c=a.slice(-1)==="/";return a=g(f(a.split("/"),function(a){return!!a}),!b).join("/"),!a&&!b&&(a="."),a&&c&&(a+="/"),(b?"/":"")+a},c.join=function(){var a=Array.prototype.slice.call(arguments,0);return c.normalize(f(a,function(a,b){return a&&typeof a=="string"}).join("/"))},c.dirname=function(a){var b=h.exec(a)[1]||"",c=!1;return b?b.length===1||c&&b.length<=3&&b.charAt(1)===":"?b:b.substring(0,b.length-1):"."},c.basename=function(a,b){var c=h.exec(a)[2]||"";return b&&c.substr(-1*b.length)===b&&(c=c.substr(0,c.length-b.length)),c},c.extname=function(a){return h.exec(a)[3]||""}}),require.define("/package.json",function(a,b,c,d,e){b.exports={}}),require.define("/spire.io.js",function(a,b,c,d,e){!function(a,c){typeof define=="function"?define(c):typeof b!="undefined"?b.exports=c():this[a]=c()}("spire",function(){var b=function(a,b,c,d){this.name="XHRError",this.message=d||"XHRError",this.xhr=a,this.textStatus=b,this.status=a?a.status||a.statusCode:null};b.prototype=new Error,b.prototype.constructor=b;var c={options:{url:"https://api.spire.io",version:"1.0",timeout:3e4},cache:{},isConnecting:!1,headers:{},messages:{queue:[]},accounts:{},account:{},requests:{description:{},sessions:{},channels:{},subscriptions:{},messages:{},accounts:{},billing:{}}},d=a("shred");return c.shred=new d,c.headers.authorization=function(a){return["Capability",a.capability].join(" ")},c.headers.mediaType=function(a){return c.schema[c.options.version][a].mediaType},c.messages.subscribe=function(a,b){c.connect(function(d,e){if(d)return b(d);var f={session:e,name:a};c.requests.channels.create(f,function(d,f){if(d)return d.status===409?c.requests.sessions.get(e,function(d,e){d&&b(d);var f=e.resources.channels.resources[a];c.requests.channels.get(f,function(a,d){var f={channels:[d],events:["messages"],session:e};c.requests.subscriptions.create(f,function(a,d){if(a)return b(a);var e={subscription:d},f=0,g=function(){f++;if(c.options._maxSubscriptionCallCount<f)return;c.requests.subscriptions.get(e,function(a,c){if(a)return b(a);c.messages.length>0&&b(null,c.messages),g()})};g()})})}):b(d);var g={channels:[f],events:["messages"],session:e};c.requests.subscriptions.create(g,function(a,d){if(a)return b(a);var e={subscription:d},f=0,g=function(){f++;if(c.options._maxSubscriptionCallCount<f)return;c.requests.subscriptions.get(e,function(a,c){if(a)return b(a);c.messages.length>0&&b(null,c.messages),g()})};g()})})})},c.messages.publish=function(a,b){if(c.isConnecting){c.messages.queue.push({message:a,callback:b});return}c.connect(function(d,e){if(d)return b(d);var f={session:e,name:a.channel};c.requests.channels.create(f,function(d,f){var g={session:e,name:a.channel};if(d)return d.status===409?c.requests.sessions.get(e,function(d,e){if(d){if(b)return b(d,null);throw d}var f=e.resources.channels.resources[a.channel];c.requests.channels.get(f,function(d,e){var f={channel:e,content:a.content};c.requests.messages.create(f,function(a,c){if(a)return b(a);b&&b(null,c)})})}):b(d,null);var g={channel:f,content:a.content};c.requests.messages.create(g,function(a,c){if(a)return b(a);b&&b(null,c)})})})},c.accounts.create=function(a,b){c.requests.description.get(function(d,e){if(d)return b(d);c.requests.accounts.create(a,b)})},c.accounts.update=function(a,b){c.requests.description.get(function(d,e){if(d)return b(d);c.requests.accounts.update(a,b)})},c.accounts.authenticate=function(a,b){c.requests.description.get(function(d,e){if(d)return b(d);var f={key:c.options.key,email:a.email,password:a.password};c.requests.sessions.create(f,b)})},c.connect=function(a){c.isConnecting=!0,c.requests.description.get(function(b,d){if(b)return a(b);var e={key:c.options.key},f=function(b,d){if(b)return a(b);c.isConnecting=!1,c.session=d;if(c.messages.queue.length>0){var e;while(e=c.messages.queue.pop())e&&c.messages.publish(e.message,e.callback)}return a(null,d)};c.session?f(null,c.session):c.requests.sessions.create(e,f)})},c.requests.description.get=function(a){if(c.resources){var d={resources:c.resources,schema:c.schema};return a(null,d)}c.shred.get({url:c.options.url,headers:{accept:"application/json"},on:{error:function(c){var d=new b(c,c.status,c.status);a(d)},success:function(b){c.resources=b.body.data.resources,c.schema=b.body.data.schema,a(null,b.body.data)}}})},c.requests.sessions.get=function(a,d){c.shred.get({url:a.url,headers:{Accept:c.headers.mediaType("session"),Authorization:c.headers.authorization(a)},on:{error:function(a){var c=new b(a,a.status,a.status);d(c)},success:function(a){d(null,a.body.data)}}})},c.requests.sessions.create=function(a,d){if(!a.key&&typeof a.email!="string"&&typeof a.password!="string"){var e=["You need a key to do that! Try doing this:","   spire.options.key = <your account key>"].join("\n");throw new Error(e)}a.email&&a.password&&(a.key=null),c.shred.post({url:c.resources.sessions.url,headers:{"Content-Type":c.headers.mediaType("account"),Accept:c.headers.mediaType("session")},content:a,on:{error:function(a){var c=new b(a,a.status,a.status);d(c)},success:function(a){d(null,a.body.data)}}})},c.requests.channels.get=function(a,d){c.shred.get({url:a.url,headers:{Authorization:c.headers.authorization(a),Accept:c.headers.mediaType("channel")},on:{error:function(a){var c=new b(a,a.status,a.status);d(c)},success:function(a){d(null,a.body.data)}}})},c.requests.channels.create=function(a,d){var e=a.session.resources.channels,f=a.name;c.shred.post({url:e.url,headers:{"Content-Type":c.headers.mediaType("channel"),Accept:c.headers.mediaType("channel"),Authorization:c.headers.authorization(e)},content:{name:f},on:{error:function(a){var c=new b(a,a.status,a.status);d(c)},success:function(a){d(null,a.body.data)}}})},c.requests.subscriptions.create=function(a,d){var e=a.session.resources.subscriptions,f={events:a.events,channels:[]};for(var g=0;g<a.channels.length;g++)f.channels.push(a.channels[g].url);c.shred.post({url:e.url,headers:{"Content-Type":c.headers.mediaType("subscription"),Accept:c.headers.mediaType("subscription"),Authorization:c.headers.authorization(e)},content:f,on:{error:function(a){var c=new b(a,a.status,a.status);d(c)},success:function(a){d(null,a.body.data)}}})},c.requests.subscriptions.get=function(a,d){var e=a.subscription;data={timeout:a.timeout||c.options.timeout/1e3},e["last-message"]&&(data["last-message"]=e["last-message"]),c.shred.get({url:e.url,headers:{"Content-Type":c.headers.mediaType("events"),Accept:c.headers.mediaType("events"),Authorization:c.headers.authorization(e)},content:data,on:{timeout:function(a){d(null,{messages:[]})},error:function(a){var c=new b(a,a.status,a.status);d(c)},success:function(a){var b=a.body.data.messages.length;b>0&&(e["last-message"]=a.body.data.messages[b-1].timestamp),d(null,a.body.data)}}})},c.requests.messages.create=function(a,d){var e=a.channel,f=a.content;c.shred.post({url:e.url,headers:{"Content-Type":c.headers.mediaType("message"),Accept:c.headers.mediaType("message"),Authorization:c.headers.authorization(e)},content:{content:f},on:{error:function(a){var c=new b(a,a.status,a.status);d(c)},success:function(a){d(null,a.body.data)}}})},c.requests.accounts.create=function(a,d){c.shred.post({url:c.resources.accounts.url,headers:{"Content-Type":c.headers.mediaType("account"),Accept:c.headers.mediaType("session")},content:a,on:{error:function(a){var c=new b(a,a.status,a.status);d(c)},success:function(a){d(null,a.body.data)}}})},c.requests.accounts.update=function(a,d){c.shred.put({url:a.url,headers:{"Content-Type":c.headers.mediaType("account"),Accept:c.headers.mediaType("account"),Authorization:c.headers.authorization(a)},content:a,on:{error:function(a){var c=new b(a,a.status,a.status);d(c)},success:function(a){d(null,a.body.data)}}})},c.requests.accounts.reset=function(a,d){c.shred.post({url:a.url,headers:{"Content-Type":c.headers.mediaType("account"),Accept:c.headers.mediaType("account"),Authorization:c.headers.authorization(a)},on:{error:function(a){var c=new b(a,a.status,a.status);d(c)},success:function(a){d(null,a.body.data)}}})},c.requests.billing.get=function(a){c.shred.get({url:c.resources.billing.url,headers:{"Content-Type":c.headers.mediaType("billing"),Accept:c.headers.mediaType("billing")},on:{error:function(c){var d=new b(c,c.status,c.status);a(d)},success:function(b){a(null,b.body.data)}}})},c})}),require.define("/node_modules/shred/package.json",function(a,b,c,d,e){b.exports={main:"./lib/shred.js"}}),require.define("/node_modules/shred/lib/shred.js",function(a,b,c,d,e){var f=a("underscore"),g=a("ax"),h=a("cookiejar"),i=h.CookieAccessInfo,j=h.CookieJar,k=h.Cookie,l=function(a){a=a||{},this.defaults=a.defaults||{},this.log=a.logger||new g({level:"info"}),this._sharedCookieJar=new j};l.Request=a("./shred/request"),l.Response=a("./shred/response"),l.prototype={request:function(a){return a.logger=this.log,a.cookieJar="cookieJar"in a?a.cookieJar:this._sharedCookieJar,new l.Request(f.defaults(a,this.defaults))}},"get put post delete".split(" ").forEach(function(a){l.prototype[a]=function(b){return b.method=a,this.request(b)}}),b.exports=l}),require.define("/node_modules/shred/node_modules/underscore/package.json",function(a,b,c,d,e){b.exports={main:"underscore.js"}}),require.define("/node_modules/shred/node_modules/underscore/underscore.js",function(a,b,c,d,e){(function(){var a=this,c=a._,d={},e=Array.prototype,f=Object.prototype,g=Function.prototype,h=e.slice,i=e.unshift,j=f.toString,k=f.hasOwnProperty,l=e.forEach,m=e.map,n=e.reduce,o=e.reduceRight,p=e.filter,q=e.every,r=e.some,s=e.indexOf,t=e.lastIndexOf,u=Array.isArray,v=Object.keys,w=g.bind,x=function(a){return new C(a)};typeof b!="undefined"&&b.exports?(b.exports=x,x._=x):a._=x,x.VERSION="1.1.7";var y=x.each=x.forEach=function(a,b,c){if(a==null)return;if(l&&a.forEach===l)a.forEach(b,c);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(e in a&&b.call(c,a[e],e,a)===d)return}else for(var g in a)if(k.call(a,g)&&b.call(c,a[g],g,a)===d)return};x.map=function(a,b,c){var d=[];return a==null?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),d)},x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=c!==void 0;a==null&&(a=[]);if(n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c},x.reduceRight=x.foldr=function(a,b,c,d){a==null&&(a=[]);if(o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),c!==void 0?a.reduceRight(b,c):a.reduceRight(b);var e=(x.isArray(a)?a.slice():x.toArray(a)).reverse();return x.reduce(e,b,c,d)},x.find=x.detect=function(a,b,c){var d;return z(a,function(a,e,f){if(b.call(c,a,e,f))return d=a,!0}),d},x.filter=x.select=function(a,b,c){var d=[];return a==null?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},x.reject=function(a,b,c){var d=[];return a==null?d:(y(a,function(a,e,f){b.call(c,a,e,f)||(d[d.length]=a)}),d)},x.every=x.all=function(a,b,c){var e=!0;return a==null?e:q&&a.every===q?a.every(b,c):(y(a,function(a,f,g){if(!(e=e&&b.call(c,a,f,g)))return d}),e)};var z=x.some=x.any=function(a,b,c){b=b||x.identity;var e=!1;return a==null?e:r&&a.some===r?a.some(b,c):(y(a,function(a,f,g){if(e|=b.call(c,a,f,g))return d}),!!e)};x.include=x.contains=function(a,b){var c=!1;return a==null?c:s&&a.indexOf===s?a.indexOf(b)!=-1:(z(a,function(a){if(c=a===b)return!0}),c)},x.invoke=function(a,b){var c=h.call(arguments,2);return x.map(a,function(a){return(b.call?b||a:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,function(a){return a[b]})},x.max=function(a,b,c){if(!b&&x.isArray(a))return Math.max.apply(Math,a);var d={computed:-Infinity};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})}),d.value},x.min=function(a,b,c){if(!b&&x.isArray(a))return Math.min.apply(Math,a);var d={computed:Infinity};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},x.sortBy=function(a,b,c){return x.pluck(x.map(a,function(a,d,e){return{value:a,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")},x.groupBy=function(a,b){var c={};return y(a,function(a,d){var e=b(a,d);(c[e]||(c[e]=[])).push(a)}),c},x.sortedIndex=function(a,b,c){c||(c=x.identity);var d=0,e=a.length;while(d<e){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d},x.toArray=function(a){return a?a.toArray?a.toArray():x.isArray(a)?h.call(a):x.isArguments(a)?h.call(a):x.values(a):[]},x.size=function(a){return x.toArray(a).length},x.first=x.head=function(a,b,c){return b!=null&&!c?h.call(a,0,b):a[0]},x.rest=x.tail=function(a,b,c){return h.call(a,b==null||c?1:b)},x.last=function(a){return a[a.length-1]},x.compact=function(a){return x.filter(a,function(a){return!!a})},x.flatten=function(a){return x.reduce(a,function(a,b){return x.isArray(b)?a.concat(x.flatten(b)):(a[a.length]=b,a)},[])},x.without=function(a){return x.difference(a,h.call(arguments,1))},x.uniq=x.unique=function(a,b){return x.reduce(a,function(a,c,d){if(0==d||(b===!0?x.last(a)!=c:!x.include(a,c)))a[a.length]=c;return a},[])},x.union=function(){return x.uniq(x.flatten(arguments))},x.intersection=x.intersect=function(a){var b=h.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.indexOf(b,a)>=0})})},x.difference=function(a,b){return x.filter(a,function(a){return!x.include(b,a)})},x.zip=function(){var a=h.call(arguments),b=x.max(x.pluck(a,"length")),c=new Array(b);for(var d=0;d<b;d++)c[d]=x.pluck(a,""+d);return c},x.indexOf=function(a,b,c){if(a==null)return-1;var d,e;if(c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;if(s&&a.indexOf===s)return a.indexOf(b);for(d=0,e=a.length;d<e;d++)if(a[d]===b)return d;return-1},x.lastIndexOf=function(a,b){if(a==null)return-1;if(t&&a.lastIndexOf===t)return a.lastIndexOf(b);var c=a.length;while(c--)if(a[c]===b)return c;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);while(e<d)f[e++]=a,a+=c;return f},x.bind=function(a,b){if(a.bind===w&&w)return w.apply(a,h.call(arguments,1));var c=h.call(arguments,2);return function(){return a.apply(b,c.concat(h.call(arguments)))}},x.bindAll=function(a){var b=h.call(arguments,1);return b.length==0&&(b=x.functions(a)),y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return k.call(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(a,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))};var A=function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,a.apply(e,f)};c&&clearTimeout(d);if(c||!d)d=setTimeout(g,b)}};x.throttle=function(a,b){return A(a,b,!1)},x.debounce=function(a,b){return A(a,b,!0)},x.once=function(a){var b=!1,c;return function(){return b?c:(b=!0,c=a.apply(this,arguments))}},x.wrap=function(a,b){return function(){var c=[a].concat(h.call(arguments));return b.apply(this,c)}},x.compose=function(){var a=h.call(arguments);return function(){var b=h.call(arguments);for(var c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return function(){if(--a<1)return b.apply(this,arguments)}},x.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)k.call(a,c)&&(b[b.length]=c);return b},x.values=function(a){return x.map(a,x.identity)},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(h.call(arguments,1),function(b){for(var c in b)b[c]!==void 0&&(a[c]=b[c])}),a},x.defaults=function(a){return y(h.call(arguments,1),function(b){for(var c in b)a[c]==null&&(a[c]=b[c])}),a},x.clone=function(a){return x.isArray(a)?a.slice():x.extend({},a)},x.tap=function(a,b){return b(a),a},x.isEqual=function(a,b){if(a===b)return!0;var c=typeof a,d=typeof b;if(c!=d)return!1;if(a==b)return!0;if(!a&&b||a&&!b)return!1;a._chain&&(a=a._wrapped),b._chain&&(b=b._wrapped);if(a.isEqual)return a.isEqual(b);if(b.isEqual)return b.isEqual(a);if(x.isDate(a)&&x.isDate(b))return a.getTime()===b.getTime();if(x.isNaN(a)&&x.isNaN(b))return!1;if(x.isRegExp(a)&&x.isRegExp(b))return a.source===b.source&&a.global===b.global&&a.ignoreCase===b.ignoreCase&&a.multiline===b.multiline;if(c!=="object")return!1;if(a.length&&a.length!==b.length)return!1;var e=x.keys(a),f=x.keys(b);if(e.length!=f.length)return!1;for(var g in a)if(!(g in b)||!x.isEqual(a[g],b[g]))return!1;return!0},x.isEmpty=function(a){if(x.isArray(a)||x.isString(a))return a.length===0;for(var b in a)if(k.call(a,b))return!1;return!0},x.isElement=function(a){return!!a&&a.nodeType==1},x.isArray=u||function(a){return j.call(a)==="[object Array]"},x.isObject=function(a){return a===Object(a)},x.isArguments=function(a){return!!a&&!!k.call(a,"callee")},x.isFunction=function(a){return!!(a&&a.constructor&&a.call&&a.apply)},x.isString=function(a){return!!(a===""||a&&a.charCodeAt&&a.substr)},x.isNumber=function(a){return!!(a===0||a&&a.toExponential&&a.toFixed)},x.isNaN=function(a){return a!==a},x.isBoolean=function(a){return a===!0||a===!1},x.isDate=function(a){return!!(a&&a.getTimezoneOffset&&a.setUTCFullYear)},x.isRegExp=function(a){return!(!(a&&a.test&&a.exec)||!a.ignoreCase&&a.ignoreCase!==!1)},x.isNull=function(a){return a===null},x.isUndefined=function(a){return a===void 0},x.noConflict=function(){return a._=c,this},x.identity=function(a){return a},x.times=function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)},x.mixin=function(a){y(x.functions(a),function(b){E(b,x[b]=a[b])})};var B=0;x.uniqueId=function(a){var b=B++;return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g},x.template=function(a,b){var c=x.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.interpolate,function(a,b){return"',"+b.replace(/\\'/g,"'")+",'"}).replace(c.evaluate||null,function(a,b){return"');"+b.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj",d);return b?e(b):e};var C=function(a){this._wrapped=a};x.prototype=C.prototype;var D=function(a,b){return b?x(a).chain():a},E=function(a,b){C.prototype[a]=function(){var a=h.call(arguments);return i.call(a,this._wrapped),D(b.apply(x,a),this._chain)}};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=e[a];C.prototype[a]=function(){return b.apply(this._wrapped,arguments),D(this._wrapped,this._chain)}}),y(["concat","join","slice"],function(a){var b=e[a];C.prototype[a]=function(){return D(b.apply(this._wrapped,arguments),this._chain)}}),C.prototype.chain=function(){return this._chain=!0,this},C.prototype.value=function(){return this._wrapped}})()}),require.define("/node_modules/shred/node_modules/ax/package.json",function(a,b,c,d,e){b.exports={main:"./lib/ax.js"}}),require.define("/node_modules/shred/node_modules/ax/lib/ax.js",function(a,b,c,d,e){var f=a("util").inspect,g=a("fs"),h=a("colors"),i=a("underscore"),j=function(a,b){var c=a=="debug"||a=="error";return b?typeof b=="object"?b instanceof Error&&c?b.stack:f(b):b.toString():b.toString()},k=function(a){return this},l=function(a,b){return function(b){return this.stream.write(this.format(a,b)+"\n"),this}},m=function(a){var b=this,a=a||{};b.options=i.defaults(a,{level:"info",colors:{info:"green",warn:"yellow",debug:"cyan",error:"red"},prefix:""}),b.options.module&&(b.options.prefix=b.options.module+": "),b.options.file?b.stream=g.createWriteStream(b.options.file):process.title==="node"?b.stream=process.stderr:process.title==="browser"&&(b.stream=console[b.options.level]);switch(b.options.level){case"debug":i.each(["debug","info","warn"],function(a){b[a]=m.writer(a)});case"info":i.each(["info","warn"],function(a){b[a]=m.writer(a)});case"warn":b.warn=m.writer("warn")}};m.writer=function(a){return function(b){var c=this;process.title==="node"?c.stream.write(c.format(a,b)+"\n"):process.title==="browser"&&c.stream(c.format(a,b)+"\n")}},m.prototype={info:function(){},debug:function(){},warn:function(){},error:m.writer("error"),format:function(a,b){if(!b)return"";var c=this,d=c.options.prefix,e=c.options.colors[a];return(d+b)[e]}},b.exports=m}),require.define("util",function(a,b,c,d,e){}),require.define("fs",function(a,b,c,d,e){}),require.define("/node_modules/shred/node_modules/ax/node_modules/colors/package.json",function(a,b,c,d,e){b.exports={main:"colors"}}),require.define("/node_modules/shred/node_modules/ax/node_modules/colors/colors.js",function(a,b,c,d,e){function g(a,b){var c={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[90,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};return"["+c[b][0]+"m"+a+"["+c[b][1]+"m"}function h(a,b){function f(a){return r=Math.floor(Math.random()*a),r}function g(a){var b=!1;return d.filter(function(c){b=c==a}),b}function h(a,b){result="",b=b||{},b.up=b.up||!0,b.mid=b.mid||!0,b.down=b.down||!0,b.size=b.size||"maxi";var d;a=a.split("");for(var e in a){if(g(e))continue;result+=a[e],d={up:0,down:0,mid:0};switch(b.size){case"mini":d.up=f(8),d.min=f(2),d.down=f(8);break;case"maxi":d.up=f(16)+3,d.min=f(4)+1,d.down=f(64)+3;break;default:d.up=f(8)+1,d.mid=f(6)/2,d.down=f(8)+1}var h=["up","mid","down"];for(var i in h){var j=h[i];for(var k=0;k<=d[j];k++)b[j]&&(result+=c[j][f(c[j].length)])}}return result}var c={up:["̍","̎","̄","̅","̿","̑","̆","̐","͒","͗","͑","̇","̈","̊","͂","̓","̈","͊","͋","͌","̃","̂","̌","͐","̀","́","̋","̏","̒","̓","̔","̽","̉","ͣ","ͤ","ͥ","ͦ","ͧ","ͨ","ͩ","ͪ","ͫ","ͬ","ͭ","ͮ","ͯ","̾","͛","͆","̚"],down:["̖","̗","̘","̙","̜","̝","̞","̟","̠","̤","̥","̦","̩","̪","̫","̬","̭","̮","̯","̰","̱","̲","̳","̹","̺","̻","̼","ͅ","͇","͈","͉","͍","͎","͓","͔","͕","͖","͙","͚","̣"],mid:["̕","̛","̀","́","͘","̡","̢","̧","̨","̴","̵","̶","͜","͝","͞","͟","͠","͢","̸","̷","͡"," ҉"]},d=[].concat(c.up,c.down,c.mid),e={};return h(a)}var f=typeof b!="undefined";["bold","underline","italic","inverse","grey","yellow","red","green","blue","white","cyan","magenta"].forEach(function(a){String.prototype.__defineGetter__(a,function(){return f?g(this,a):this.replace(/( )/,"$1")})}),String.prototype.__defineGetter__("rainbow",function(){if(!f)return this.replace(/( )/,"$1");var a=["red","yellow","green","blue","magenta"],b=this.split(""),c=0;return b=b.map(function(b){return b==" "?b:g(b,a[c++%a.length])}),b.join("")}),String.prototype.__defineGetter__("zalgo",function(){return h(this)})}),require.define("/node_modules/shred/node_modules/ax/node_modules/underscore/package.json",function(a,b,c,d,e){b.exports={main:"underscore.js"}}),require.define("/node_modules/shred/node_modules/ax/node_modules/underscore/underscore.js",function(a,b,c,d,e){(function(){function B(a,b,c){if(a===b)return a!==0||1/a==1/b;if(a==null)return a===b;var d=typeof a;if(d!=typeof b)return!1;if(!a!=!b)return!1;if(x.isNaN(a))return x.isNaN(b);var e=x.isString(a),f=x.isString(b);if(e||f)return e&&f&&String(a)==String(b);var g=x.isNumber(a),h=x.isNumber(b);if(g||h)return g&&h&&+a==+b;var i=x.isBoolean(a),j=x.isBoolean(b);if(i||j)return i&&j&&+a==+b;var l=x.isDate(a),m=x.isDate(b);if(l||m)return l&&m&&a.getTime()==b.getTime();var n=x.isRegExp(a),o=x.isRegExp(b);if(n||o)return n&&o&&a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase;if(d!="object")return!1;a._chain&&(a=a._wrapped),b._chain&&(b=b._wrapped);if(x.isFunction(a.isEqual))return a.isEqual(b);var p=c.length;while(p--)if(c[p]==a)return!0;c.push(a);var q=0,r=!0;if(a.length===+a.length||b.length===+b.length){q=a.length,r=q==b.length;if(r)while(q--)if(!(r=q in a==q in b&&B(a[q],b[q],c)))break}else{for(var s in a)if(k.call(a,s)){q++;if(!(r=k.call(b,s)&&B(a[s],b[s],c)))break}if(r){for(s in b)if(k.call(b,s)&&!(q--))break;r=!q}}return c.pop(),r}var a=this,c=a._,d={},e=Array.prototype,f=Object.prototype,g=Function.prototype,h=e.slice,i=e.unshift,j=f.toString,k=f.hasOwnProperty,l=e.forEach,m=e.map,n=e.reduce,o=e.reduceRight,p=e.filter,q=e.every,r=e.some,s=e.indexOf,t=e.lastIndexOf,u=Array.isArray,v=Object.keys,w=g.bind,x=function(a){return new D(a)};typeof b!="undefined"&&b.exports?(b.exports=x,x._=x):a._=x,x.VERSION="1.2.0";var y=x.each=x.forEach=function(a,b,c){if(a==null)return;if(l&&a.forEach===l)a.forEach(b,c);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(e in a&&b.call(c,a[e],e,a)===d)return}else for(var g in a)if(k.call(a,g)&&b.call(c,a[g],g,a)===d)return};x.map=function(a,b,c){var d=[];return a==null?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),d)},x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=c!==void 0;a==null&&(a=[]);if(n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c},x.reduceRight=x.foldr=function(a,b,c,d){a==null&&(a=[]);if(o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),c!==void 0?a.reduceRight(b,c):a.reduceRight(b);var e=(x.isArray(a)?a.slice():x.toArray(a)).reverse();return x.reduce(e,b,c,d)},x.find=x.detect=function(a,b,c){var d;return z(a,function(a,e,f){if(b.call(c,a,e,f))return d=a,!0}),d},x.filter=x.select=function(a,b,c){var d=[];return a==null?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},x.reject=function(a,b,c){var d=[];return a==null?d:(y(a,function(a,e,f){b.call(c,a,e,f)||(d[d.length]=a)}),d)},x.every=x.all=function(a,b,c){var e=!0;return a==null?e:q&&a.every===q?a.every(b,c):(y(a,function(a,f,g){if(!(e=e&&b.call(c,a,f,g)))return d}),e)};var z=x.some=x.any=function(a,b,c){b=b||x.identity;var e=!1;return a==null?e:r&&a.some===r?a.some(b,c):(y(a,function(a,f,g){if(e|=b.call(c,a,f,g))return d}),!!e)};x.include=x.contains=function(a,b){var c=!1;return a==null?c:s&&a.indexOf===s?a.indexOf(b)!=-1:(z(a,function(a){if(c=a===b)return!0}),c)},x.invoke=function(a,b){var c=h.call(arguments,2);return x.map(a,function(a){return(b.call?b||a:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,function(a){return a[b]})},x.max=function(a,b,c){if(!b&&x.isArray(a))return Math.max.apply(Math,a);if(!b&&x.isEmpty(a))return-Infinity;var d={computed:-Infinity};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})}),d.value},x.min=function(a,b,c){if(!b&&x.isArray(a))return Math.min.apply(Math,a);if(!b&&x.isEmpty(a))return Infinity;var d={computed:Infinity};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},x.shuffle=function(a){var b=[],c;return y(a,function(a,d,e){d==0?b[0]=a:(c=Math.floor(Math.random()*(d+1)),b[d]=b[c],b[c]=a)}),b},x.sortBy=function(a,b,c){return x.pluck(x.map(a,function(a,d,e){return{value:a,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")},x.groupBy=function(a,b){var c={};return y(a,function(a,d){var e=b(a,d);(c[e]||(c[e]=[])).push(a)}),c},x.sortedIndex=function(a,b,c){c||(c=x.identity);var d=0,e=a.length;while(d<e){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d},x.toArray=function(a){return a?a.toArray?a.toArray():x.isArray(a)?h.call(a):x.isArguments(a)?h.call(a):x.values(a):[]},x.size=function(a){return x.toArray(a).length},x.first=x.head=function(a,b,c){return b!=null&&!c?h.call(a,0,b):a[0]},x.initial=function(a,b,c){return h.call(a,0,a.length-(b==null||c?1:b))},x.last=function(a,b,c){return b!=null&&!c?h.call(a,a.length-b):a[a.length-1]},x.rest=x.tail=function(a,b,c){return h.call(a,b==null||c?1:b)},x.compact=function(a){return x.filter(a,function(a){return!!a})},x.flatten=function(a){return x.reduce(a,function(a,b){return x.isArray(b)?a.concat(x.flatten(b)):(a[a.length]=b,a)},[])},x.without=function(a){return x.difference(a,h.call(arguments,1))},x.uniq=x.unique=function(a,b,c){var d=c?x.map(a,c):a,e=[];return x.reduce(d,function(c,d,f){if(0==f||(b===!0?x.last(c)!=d:!x.include(c,d)))c[c.length]=d,e[e.length]=a[f];return c},[]),e},x.union=function(){return x.uniq(x.flatten(arguments))},x.intersection=x.intersect=function(a){var b=h.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.indexOf(b,a)>=0})})},x.difference=function(a,b){return x.filter(a,function(a){return!x.include(b,a)})},x.zip=function(){var a=h.call(arguments),b=x.max(x.pluck(a,"length")),c=new Array(b);for(var d=0;d<b;d++)c[d]=x.pluck(a,""+d);return c},x.indexOf=function(a,b,c){if(a==null)return-1;var d,e;if(c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;if(s&&a.indexOf===s)return a.indexOf(b);for(d=0,e=a.length;d<e;d++)if(a[d]===b)return d;return-1},x.lastIndexOf=function(a,b){if(a==null)return-1;if(t&&a.lastIndexOf===t)return a.lastIndexOf(b);var c=a.length;while(c--)if(a[c]===b)return c;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);while(e<d)f[e++]=a,a+=c;return f},x.bind=function(a,b){if(a.bind===w&&w)return w.apply(a,h.call(arguments,1));var c=h.call(arguments,2);return function(){return a.apply(b,c.concat(h.call(arguments)))}},x.bindAll=function(a){var b=h.call(arguments,1);return b.length==0&&(b=x.functions(a)),y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return k.call(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(a,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))};var A=function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,a.apply(e,f)};c&&clearTimeout(d);if(c||!d)d=setTimeout(g,b)}};x.throttle=function(a,b){return A(a,b,!1)},x.debounce=function(a,b){return A(a,b,!0)},x.once=function(a){var b=!1,c;return function(){return b?c:(b=!0,c=a.apply(this,arguments))}},x.wrap=function(a,b){return function(){var c=[a].concat(h.call(arguments));return b.apply(this,c)}},x.compose=function(){var a=h.call(arguments);return function(){var b=h.call(arguments);for(var c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return function(){if(--a<1)return b.apply(this,arguments)}},x.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)k.call(a,c)&&(b[b.length]=c);return b},x.values=function(a){return x.map(a,x.identity)},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(h.call(arguments,1),function(b){for(var c in b)b[c]!==void 0&&(a[c]=b[c])}),a},x.defaults=function(a){return y(h.call(arguments,1),function(b){for(var c in b)a[c]==null&&(a[c]=b[c])}),a},x.clone=function(a){return x.isArray(a)?a.slice():x.extend({},a)},x.tap=function(a,b){return b(a),a},x.isEqual=function(a,b){return B(a,b,[])},x.isEmpty=function(a){if(x.isArray(a)||x.isString(a))return a.length===0;for(var b in a)if(k.call(a,b))return!1;return!0},x.isElement=function(a){return!!a&&a.nodeType==1},x.isArray=u||function(a){return j.call(a)==="[object Array]"},x.isObject=function(a){return a===Object(a)},x.isArguments=function(a){return!!a&&!!k.call(a,"callee")},x.isFunction=function(a){return!!(a&&a.constructor&&a.call&&a.apply)},x.isString=function(a){return!!(a===""||a&&a.charCodeAt&&a.substr)},x.isNumber=function(a){return!!(a===0||a&&a.toExponential&&a.toFixed)},x.isNaN=function(a){return a!==a},x.isBoolean=function(a){return a===!0||a===!1||j.call(a)=="[object Boolean]"},x.isDate=function(a){return!!(a&&a.getTimezoneOffset&&a.setUTCFullYear)},x.isRegExp=function(a){return!(!(a&&a.test&&a.exec)||!a.ignoreCase&&a.ignoreCase!==!1)},x.isNull=function(a){return a===null},x.isUndefined=function(a){return a===void 0},x.noConflict=function(){return a._=c,this},x.identity=function(a){return a},x.times=function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)},x.escape=function(a){return(""+a).replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},x.mixin=function(a){y(x.functions(a),function(b){F(b,x[b]=a[b])})};var C=0;x.uniqueId=function(a){var b=C++;return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},x.template=function(a,b){var c=x.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.escape,function(a,b){return"',_.escape("+b.replace(/\\'/g,"'")+"),'"}).replace(c.interpolate,function(a,b){return"',"+b.replace(/\\'/g,"'")+",'"}).replace(c.evaluate||null,function(a,b){return"');"+b.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj",d);return b?e(b):e};var D=function(a){this._wrapped=a};x.prototype=D.prototype;var E=function(a,b){return b?x(a).chain():a},F=function(a,b){D.prototype[a]=function(){var a=h.call(arguments);return i.call(a,this._wrapped),E(b.apply(x,a),this._chain)}};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=e[a];D.prototype[a]=function(){return b.apply(this._wrapped,arguments),E(this._wrapped,this._chain)}}),y(["concat","join","slice"],function(a){var b=e[a];D.prototype[a]=function(){return E(b.apply(this._wrapped,arguments),this._chain)}}),D.prototype.chain=function(){return this._chain=!0,this},D.prototype.value=function(){return this._wrapped}})()}),require.define("/node_modules/shred/node_modules/cookiejar/package.json",function(a,b,c,d,e){b.exports={main:"cookiejar.js"}}),require.define("/node_modules/shred/node_modules/cookiejar/cookiejar.js",function(a,b,c,d,e){c.CookieAccessInfo=CookieAccessInfo=function g(a,b,c,d){return this instanceof g?(this.domain=a||undefined,this.path=b||"/",this.secure=!!c,this.script=!!d,this):new g(a,b,c,d)},c.Cookie=Cookie=function h(a){return a instanceof h?a:this instanceof h?(this.name=null,this.value=null,this.expiration_date=Infinity,this.path="/",this.domain=null,this.secure=!1,this.noscript=!1,a&&this.parse(a),this):new h(a)},Cookie.prototype.toString=function(){var a=[this.name+"="+this.value];return this.expiration_date!==Infinity&&a.push("expires="+(new Date(this.expiration_date)).toGMTString()),this.domain&&a.push("domain="+this.domain),this.path&&a.push("path="+this.path),this.secure&&a.push("secure"),this.noscript&&a.push("httponly"),a.join("; ")},Cookie.prototype.toValueString=function(){return this.name+"="+this.value};var f=/[:](?=\s*[a-zA-Z0-9_\-]+\s*[=])/g;Cookie.prototype.parse=function(a){if(this instanceof Cookie){var b=a.split(";"),c=b[0].match(/([^=]+)=((?:.|\n)*)/),d=c[1],e=c[2];this.name=d,this.value=e;for(var f=1;f<b.length;f++){c=b[f].match(/([^=]+)(?:=((?:.|\n)*))?/),d=c[1].trim().toLowerCase(),e=c[2];switch(d){case"httponly":this.noscript=!0;break;case"expires":this.expiration_date=e?Number(Date.parse(e)):Infinity;break;case"path":this.path=e?e.trim():"";break;case"domain":this.domain=e?e.trim():"";break;case"secure":this.secure=!0}}return this}return(new Cookie).parse(a)},Cookie.prototype.matches=function(a){return this.noscript&&a.script||this.secure&&!a.secure||!this.collidesWith(a)?!1:!0},Cookie.prototype.collidesWith=function(a){if(this.path&&!a.path||this.domain&&!a.domain)return!1;if(this.path&&a.path.indexOf(this.path)!==0)return!1;if(this.domain===a.domain)return!0;if(this.domain&&this.domain.charAt(0)==="."){var b=a.domain.indexOf(this.domain.slice(1));if(b===-1||b!==a.domain.length-this.domain.length+1)return!1}else if(this.domain)return!1;return!0},c.CookieJar=CookieJar=function n(){if(this instanceof n){var a={};return this.setCookie=function b(b){b=Cookie(b);var c=b.expiration_date<=Date.now();if(b.name in a){var d=a[b.name];for(var e=0;e<d.length;e++){var f=d[e];if(f.collidesWith(b))return c?(d.splice(e,1),d.length===0&&delete a[b.name],!1):d[e]=b}return c?!1:(d.push(b),b)}return c?!1:a[b.name]=[b]},this.getCookie=function c(b,c){var d=a[b];for(var e=0;e<d.length;e++){var f=d[e];if(f.expiration_date<=Date.now()){d.length===0&&delete a[f.name];continue}if(f.matches(c))return f}},this.getCookies=function d(b){var c=[];for(var d in a){var e=this.getCookie(d,b);e&&c.push(e)}return c.toString=function(){return c.join(":")},c.toValueString=function(){return c.map(function(a){return a.toValueString()}).join(";")},c},this}return new n},CookieJar.prototype.setCookies=function(a){a=Array.isArray(a)?a:a.split(f);var b=[];for(var c=0;c<a.length;c++){var d=Cookie(a[c]);this.setCookie(d)&&b.push(d)}return b}}),require.define("/node_modules/shred/lib/shred/request.js",function(a,b,c,d,e){var f=a("http"),g=a("https"),h=a("./parseUri"),i=a("querystring"),j=a("events").EventEmitter,k=a("sprintf").sprintf,l=a("underscore"),m=a("./response"),n=a("./mixins/headers"),o=a("./content"),p=function(a){this.log=a.logger,this.cookieJar=a.cookieJar,q(this,a||{}),r(this)};Object.defineProperties(p.prototype,{url:{get:function(){return this.scheme?k("%s://%s:%s%s",this.scheme,this.host,this.port,(this.proxy?"/":this.path)+(this.query?"?"+this.query:"")):null},set:function(a){return a=h(a),this.scheme=a.protocol,this.host=a.host,this.port=a.port,this.path=a.path,this.query=a.query,this},enumerable:!0},headers:{get:function(){return this.getHeaders()},enumerable:!0},port:{get:function(){if(!this._port)switch(this.scheme){case"https":return this._port=443;case"http":default:return this._port=80}return this._port},set:function(a){return this._port=a,this},enumerable:!0},method:{get:function(){return this._method=this._method||"GET"},set:function(a){return this._method=a,this},enumerable:!0},query:{get:function(){return this._query},set:function(a){return a&&(typeof a=="object"?a=i.stringify(a):a=i.stringify(i.parse(a.toString()))),a?this._query="?"+a:this._query="",this},enumerable:!0},parameters:{get:function(){return i.parse(this._query||"")},enumerable:!0},body:{get:function(){return this._body},set:function(a){return this._body=new o({data:a,type:this.getHeader("Content-Type")}),this.setHeader("Content-Type",this.content.type),this.setHeader("Content-Length",this.content.length),this},enumerable:!0},timeout:{get:function(){return this._timeout},set:function(a){var b=this,c=0;return a?(typeof options=="number"?c=options:c=(options.milliseconds||0)+1e3*((options.seconds||0)+60*((options.minutes||0)+60*(options.hours||0))),this._timeout=c,this):this},enumerable:!0}}),Object.defineProperty(p.prototype,"content",Object.getOwnPropertyDescriptor(p.prototype,"body")),l.extend(p.prototype,{inspect:function(){var a=this,b=l(a.headers).reduce(function(a,b,c){return a.push("\t"+c+": "+b),a},[]).join("\n"),c=["<Shred Request> ",a.method.toUpperCase(),a.url].join(" ");return[c,"- Headers:",b].join("\n")}}),l.extend(p.prototype,{on:function(a,b){var c=this.emitter;return arguments.length===1&&typeof a=="function"?c.on("response",a):arguments.length===1&&typeof a=="object"?l(a).each(function(a,b){c.on(b,a)}):c.on(a,b),this}}),n.gettersAndSetters(p);var q=function(a,b){a.log.debug("Processing request options .."),a.emitter=new j,b.on&&l(b.on).each(function(b,c){a.emitter.on(c,b)});if(!b.url&&!b.host){a.emitter.emit("request_error",new Error("No url or url options (host, port, etc.)"));return}b.url&&(b.proxy?(a.url=b.proxy,a.path=b.url):a.url=b.url),a.query=b.query||b.parameters,a.method=b.method,a.setHeader("user-agent",b.agent||"Shred for Node.js, Version 0.5.0"),a.setHeaders(b.headers);if(a.cookieJar){var c=a.cookieJar.getCookies(CookieAccessInfo(a.host,a.path));if(c.length){var d=a.getHeader("cookie")||"";for(var e=0;e<c.length;++e)d.length&&d[d.length-1]!=";"&&(d+=";"),d+=c[e].name+"="+c[e].value+";";a.setHeader("cookie",d)}}if(b.body||b.content)a.content=b.body||b.content;a.timeout=b.timeout},r=function(a){var b;a.log.debug("Creating request .."),a.log.debug(a);var c=a.scheme=="http"?f:g;a._raw=c.request({host:a.host,port:a.port,method:a.method,path:a.path+a.query,headers:a.getHeaders()},function(c){a.log.debug("Received response .."),clearTimeout(b),c=new m(c,a,function(b){var c=function(c){a.emitter.listeners(b.status).length>0?a.emitter.emit(b.status,b):a.emitter.listeners(c).length>0?a.emitter.emit(c,b):b.isRedirect||(a.emitter.emit("response",b),console.warn("Request has no event listener for status code "+b.status))};b.isRedirect?(a.log.debug("Redirecting to "+b.getHeader("Location")),a.url=b.getHeader("Location"),c("redirect"),r(a)):b.isError?c("error"):c("success")})}),a._raw.on("error",function(b){a.emitter.emit("request_error",b)}),a._raw.on("socket",function(){a._raw.socket.on("timeout",function(){a._raw.abort()})}),a.content&&(a.log.debug("Streaming body: '"+a.content.body.slice(0,59)+"' ... "),a._raw.write(a.content.body)),a.timeout&&(b=setTimeout(function(){a.log.debug("Timeout fired, aborting request ..."),a._raw.abort(),a.emit("timeout",a)},a.timeout)),a.log.debug("Sending request ..."),a._raw.end()};b.exports=p}),require.define("http",function(a,b,c,d,e){}),require.define("https",function(a,b,c,d,e){}),require.define("/node_modules/shred/lib/shred/parseUri.js",function(a,b,c,d,e){function f(a){var b=f.options,c=b.parser[b.strictMode?"strict":"loose"].exec(a),d={},e=14;while(e--)d[b.key[e]]=c[e]||"";return d[b.q.name]={},d[b.key[12]].replace(b.q.parser,function(a,c,e){c&&(d[b.q.name][c]=e)}),d}f.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},b.exports=f}),require.define("querystring",function(a,b,c,d,e){function j(a,b){if(!b)throw new TypeError("stringify expects an object");return b+"="+encodeURIComponent(a)}function k(a,b){var c=[];if(!b)throw new TypeError("stringify expects an object");for(var d=0;d<a.length;d++)c.push(i(a[d],b+"[]"));return c.join("&")}function l(a,b){var c=[],d=Object.keys(a),e;for(var f=0,g=d.length;f<g;++f)e=d[f],c.push(i(a[e],b?b+"["+encodeURIComponent(e)+"]":encodeURIComponent(e)));return c.join("&")}function m(a,b,c){var d=a[b];undefined===d?a[b]=c:f(d)?d.push(c):a[b]=[d,c]}function n(a){var b=a.length,c,d;for(var e=0;e<b;++e){d=a[e],"]"==d&&(c=!1),"["==d&&(c=!0);if("="==d&&!c)return e}}var f=typeof Array.isArray=="function"?Array.isArray:function(a){return Object.toString.call(a)==="[object Array]"};c.version="0.3.1";var g=Object.prototype.toString,h=/[^0-9]/;c.parse=function(a){function b(a,b){if(a[b].length==0)return a[b]={};var c={};for(var d in a[b])c[d]=a[b][d];return a[b]=c,c}return null==a||""==a?{}:String(a).split("&").reduce(function(a,c){try{c=decodeURIComponent(c.replace(/\+/g," "))}catch(d){}var e=c.indexOf("="),g=n(c),i=c.substr(0,g||e),j=c.substr(g||e,c.length),j=j.substr(j.indexOf("=")+1,j.length),k=a;""==i&&(i=c,j="");if(~i.indexOf("]")){var l=i.split("["),o=l.length,p=o-1;function q(a,c,d){var e=a.shift();e?(obj=c[d]=c[d]||[],"]"==e?f(obj)?""!=j&&obj.push(j):"object"==typeof obj?obj[Object.keys(obj).length]=j:obj=c[d]=[c[d],j]:~e.indexOf("]")?(e=e.substr(0,e.length-1),h.test(e)&&f(obj)&&(obj=b(c,d)),q(a,obj,e)):(h.test(e)&&f(obj)&&(obj=b(c,d)),q(a,obj,e))):f(c[d])?c[d].push(j):"object"==typeof c[d]?c[d]=j:"undefined"==typeof c[d]?c[d]=j:c[d]=[c[d],j]}q(l,k,"base")}else{if(h.test(i)&&f(k.base)){var r={};for(var s in k.base)r[s]=k.base[s];k.base=r}m(k.base,i,j)}return a},{base:{}}).base};var i=c.stringify=function(a,b){return f(a)?k(a,b):"[object Object]"==g.call(a)?l(a,b):"string"==typeof a?j(a,b):b}}),require.define("events",function(a,b,c,d,e){process.EventEmitter||(process.EventEmitter=function(){});var f=c.EventEmitter=process.EventEmitter,g=typeof Array.isArray=="function"?Array.isArray:function(a){return Object.toString.call(a)==="[object Array]"},h=10;f.prototype.setMaxListeners=function(a){this._events||(this._events={}),this._events.maxListeners=a},f.prototype.emit=function(a){if(a==="error")if(!this._events||!this._events.error||g(this._events.error)&&!this._events.error.length)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var b=this._events[a];if(!b)return!1;if(typeof b=="function"){switch(arguments.length){case 1:b.call(this);break;case 2:b.call(this,arguments[1]);break;case 3:b.call(this,arguments[1],arguments[2]);break;default:var c=Array.prototype.slice.call(arguments,1);b.apply(this,c)}return!0}if(g(b)){var c=Array.prototype.slice.call(arguments,1),d=b.slice();for(var e=0,f=d.length;e<f;e++)d[e].apply(this,c);return!0}return!1},f.prototype.addListener=function(a,b){if("function"!=typeof b)throw new Error("addListener only takes instances of Function");this._events||(this._events={}),this.emit("newListener",a,b);if(!this._events[a])this._events[a]=b;else if(g(this._events[a])){if(!this._events[a].warned){var c;this._events.maxListeners!==undefined?c=this._events.maxListeners:c=h,c&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),console.trace())}this._events[a].push(b)}else this._events[a]=[this._events[a],b];return this},f.prototype.on=f.prototype.addListener,f.prototype.once=function(a,b){var c=this;return c.on(a,function d(){c.removeListener(a,d),b.apply(this,arguments)}),this},f.prototype.removeListener=function(a,b){if("function"!=typeof b)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[a])return this;var c=this._events[a];if(g(c)){var d=c.indexOf(b);if(d<0)return this;c.splice(d,1),c.length==0&&delete this._events[a]}else this._events[a]===b&&delete this._events[a];return this},f.prototype.removeAllListeners=function(a){return a&&this._events&&this._events[a]&&(this._events[a]=null),this},f.prototype.listeners=function(a){return this._events||(this._events={}),this._events[a]||(this._events[a]=[]),g(this._events[a])||(this._events[a]=[this._events[a]]),this._events[a]}}),require.define("/node_modules/shred/node_modules/sprintf/package.json",function(a,b,c,d,e){b.exports={main:"./lib/sprintf"}}),require.define("/node_modules/shred/node_modules/sprintf/lib/sprintf.js",function(a,b,c,d,e){var f=function(){function a(a){return Object.prototype.toString.call(a).slice(8,-1).toLowerCase()}function b(a,b){for(var c=[];b>0;c[--b]=a);return c.join("")}var c=function(){return c.cache.hasOwnProperty(arguments[0])||(c.cache[arguments[0]]=c.parse(arguments[0])),c.format.call(null,c.cache[arguments[0]],arguments)};return c.format=function(c,d){var e=1,g=c.length,h="",i,j=[],k,l,m,n,o,p;for(k=0;k<g;k++){h=a(c[k]);if(h==="string")j.push(c[k]);else if(h==="array"){m=c[k];if(m[2]){i=d[e];for(l=0;l<m[2].length;l++){if(!i.hasOwnProperty(m[2][l]))throw f('[sprintf] property "%s" does not exist',m[2][l]);i=i[m[2][l]]}}else m[1]?i=d[m[1]]:i=d[e++];if(/[^s]/.test(m[8])&&a(i)!="number")throw f("[sprintf] expecting number but found %s",a(i));switch(m[8]){case"b":i=i.toString(2);break;case"c":i=String.fromCharCode(i);break;case"d":i=parseInt(i,10);break;case"e":i=m[7]?i.toExponential(m[7]):i.toExponential();break;case"f":i=m[7]?parseFloat(i).toFixed(m[7]):parseFloat(i);break;case"o":i=i.toString(8);break;case"s":i=(i=String(i))&&m[7]?i.substring(0,m[7]):i;break;case"u":i=Math.abs(i);break;case"x":i=i.toString(16);break;case"X":i=i.toString(16).toUpperCase()}i=/[def]/.test(m[8])&&m[3]&&i>=0?"+"+i:i,o=m[4]?m[4]=="0"?"0":m[4].charAt(1):" ",p=m[6]-String(i).length,n=m[6]?b(o,p):"",j.push(m[5]?i+n:n+i)}}return j.join("")},c.cache={},c.parse=function(a){var b=a,c=[],d=[],e=0;while(b){if((c=/^[^\x25]+/.exec(b))!==null)d.push(c[0]);else if((c=/^\x25{2}/.exec(b))!==null)d.push("%");else{if((c=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(b))===null)throw"[sprintf] huh?";if(c[2]){e|=1;var f=[],g=c[2],h=[];if((h=/^([a-z_][a-z_\d]*)/i.exec(g))===null)throw"[sprintf] huh?";f.push(h[1]);while((g=g.substring(h[0].length))!=="")if((h=/^\.([a-z_][a-z_\d]*)/i.exec(g))!==null)f.push(h[1]);else if((h=/^\[(\d+)\]/.exec(g))!==null)f.push(h[1]);else throw"[sprintf] huh?";c[2]=f}else e|=2;if(e===3)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";d.push(c)}b=b.substring(c[0].length)}return d},c}(),g=function(a,b){return b.unshift(a),f.apply(null,b)};c.sprintf=f,c.vsprintf=g}),require.define("/node_modules/shred/lib/shred/response.js",function(a,b,c,d,e){var f=a("underscore"),g=a("./content"),h=a("./mixins/headers"),i=function(b,c,d){var e=this;this._raw=b,this._setHeaders.call(this,b.headers);if(c.cookieJar&&this.getHeader("set-cookie")){var f=this.getHeader("set-cookie");for(var h=0;h<f.length;++h)f[h].match(/domain\=/i)||(f[h]+="; domain="+c.host),f[h].match(/path\=/i)||(f[h]+="; path="+c.path);c.cookieJar.setCookies(f)}this.request=c,this.client=c.client,this.log=this.request.log;var i=[],j=0;b.on("data",function(a){i.push(a),j+=a.length}),b.on("end",function(){var b;if(typeof Buffer=="undefined")b=i.join("");else{b=new Buffer(j);for(var c=0,f=0;c<i.length;c++)i[c].copy(b,f),f+=i[c].length}var h=function(a){e._body=new g({body:a,type:e.getHeader("Content-Type")}),d(e)};if(e.getHeader("Content-Encoding")==="gzip"){var k=a("zlib");k.gunzip(b,function(a,c){b=c.toString(),h(b)})}else h(b)})};i.prototype={inspect:function(){var a=this,b=f(a.headers).reduce(function(a,b,c){return a.push("\t"+c+": "+b),a},[]).join("\n"),c=["<Shred Response> ",a.status].join(" ");return[c,"- Headers:",b].join("\n")}},Object.defineProperties(i.prototype,{status:{get:function(){return this._raw.statusCode},enumerable:!0},body:{get:function(){return this._body}},content:{get:function(){return this.body},enumerable:!0},isRedirect:{get:function(){return this.status>299&&this.status<400&&this.getHeader("Location")},enumerable:!0},isError:{get:function(){return this.status>399},enumerable:!0}}),h.getters(i),h.privateSetters(i),b.exports=i}),require.define("/node_modules/shred/lib/shred/content.js",function(a,b,c,d,e){var f=a("underscore"),g=function(a){this.body=a.body,this.data=a.data,this.type=a.type};g.prototype={},Object.defineProperties(g.prototype,{type:{get:function(){if(this._type)return this._type;if(this._data)switch(typeof this._data){case"string":return"text/plain";case"object":return"application/json"}return"text/plain"},set:function(a){return this._type=a,this},enumerable:!0},data:{get:function(){return this._body?this.processor.parser(this._body):this._data},set:function(a){return this._body&&a&&j.setDataWithBody(this),this._data=a,this},enumerable:!0},body:{get:function(){return this._data?this.processor.stringify(this._data):this.processor.stringify(this._body)},set:function(a){return this._data&&a&&j.setBodyWithData(this),this._body=a,this},enumerable:!0},processor:{get:function(){var a=g.processors[this.type];return a?a:(a=f(this.type.split(";")[0].split(/\+|\//)).detect(function(a){return g.processors[a]}),g.processors[a]||{parser:h,stringify:i})},enumerable:!0},length:{get:function(){return this.body.length}}}),g.processors={},g.registerProcessor=function(a,b){a.forEach?a.forEach(function(a){g.processors[a]=b}):g.processors[a]=b};var h=function(a){return a},i=function(a){return a.toString()};g.registerProcessor(["text/html","text/plain","text"],{parser:h,stringify:i}),g.registerProcessor(["application/json; charset=utf-8","application/json","json"],{parser:function(a){return JSON.parse(a)},stringify:function(a){return JSON.stringify(a)}});var j={setDataWithBody:function(a){throw new Error("Attempt to set data attribute of a content object when the body attributes was already set.")},setBodyWithData:function(a){throw new Error("Attempt to set body attribute of a content object when the data attributes was already set.")}};b.exports=g}),require.define("/node_modules/shred/lib/shred/mixins/headers.js",function(a,b,c,d,e){var f=a("underscore"),g=function(a){return a.toLowerCase().replace("_","-").replace(/(^|-)(\w)/g,function(a){return a.toUpperCase()})},h=function(a){return{}},i=function(a){return a._headers||(a._headers=h(a))},j=function(a,b){return i(a)[g(b)]},k=function(a,b){var c=b&&b.length>0?b:Object.keys(i(a)),d=c.reduce(function(b,c){return b[c]=j(a,c),b},{});return Object.freeze(d),d},l=function(a,b,c){return i(a)[g(b)]=c,a},m=function(a,b){for(var c in b)l(a,c,b[c]);return this};b.exports={getters:function(a){a.prototype.getHeader=function(a){return j(this,a)},a.prototype.getHeaders=function(){return k(this,f(arguments))}},privateSetters:function(a){a.prototype._setHeader=function(a,b){return l(this,a,b)},a.prototype._setHeaders=function(a){return m(this,a)}},setters:function(a){a.prototype.setHeader=function(a,b){return l(this,a,b)},a.prototype.setHeaders=function(a){return m(this,a)}},gettersAndSetters:function(a){a.prototype.getHeader=function(a){return j(this,a)},a.prototype.getHeaders=function(){return k(this,f(arguments))},a.prototype.setHeader=function(a,b){return l(this,a,b)},a.prototype.setHeaders=function(a){return m(this,a)}}}}),require.define("/node_modules/http-browserify/package.json",function(a,b,c,d,e){b.exports={main:"index.js",browserify:"browser.js"}}),require.define("/node_modules/http-browserify/browser.js",function(a,b,c,d,e){var f=b.exports,g=a("events").EventEmitter,h=a("./lib/request");f.request=function(a,b){a||(a={}),a.host||(a.host=window.location.host.split(":")[0]),a.port||(a.port=window.location.port);var c=new h(new i,a);return b&&c.on("response",b),c},f.get=function(a,b){a.method="GET";var c=f.request(a,b);return c.end(),c};var i=function(){if(typeof window=="undefined")throw new Error("no window object present");if(window.XMLHttpRequest)return window.XMLHttpRequest;if(window.ActiveXObject){var a=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"];for(var b=0;b<a.length;b++)try{var c=new window.ActiveXObject(a[b]);return function(){if(c){var d=c;return c=null,d}return new window.ActiveXObject(a[b])}}catch(d){}throw new Error("ajax not supported in this browser")}throw new Error("ajax not supported in this browser")}()}),require.define("/node_modules/http-browserify/lib/request.js",function(a,b,c,d,e){var f=a("events").EventEmitter,g=a("./response"),h=b.exports=function(a,b){var c=this;c.xhr=a,c.body="";var d=b.host+":"+b.port+(b.path||"/");a.open(b.method||"GET","http://"+d,!0),b.headers&&Object.keys(b.headers).forEach(function(c){var d=b.headers[c];Array.isArray(d)?d.forEach(function(b){a.setRequestHeader(c,b)}):a.setRequestHeader(c,d)});var e=new g;e.on("ready",function(){c.emit("response",e)}),a.onreadystatechange=function(){e.handle(a)}};h.prototype=new f,h.prototype.setHeader=function(a,b){if(Array.isArray&&Array.isArray(b)||b instanceof Array)for(var c=0;c<b.length;c++)this.xhr.setRequestHeader(a,b[c]);else this.xhr.setRequestHeader(a,b)},h.prototype.write=function(a){this.body+=a},h.prototype.end=function(a){a!==undefined&&this.write(a),this.xhr.send(this.body)}}),require.define("/node_modules/http-browserify/lib/response.js",function(a,b,c,d,e){function i(a){var b=a.getAllResponseHeaders().split(/\r?\n/),c={};for(var d=0;d<b.length;d++){var e=b[d];if(e==="")continue;var f=e.match(/^([^:]+):\s*(.*)/);if(f){var g=f[1].toLowerCase(),h=f[2];c[g]!==undefined?Array.isArray&&Array.isArray(c[g])||c[g]instanceof Array?c[g].push(h):c[g]=[c[g],h]:c[g]=h}else c[e]=!0}return c}var f=a("events").EventEmitter,g=b.exports=function(a){this.offset=0};g.prototype=new f;var h={streaming:!0,status2:!0};g.prototype.getHeader=function(a){return this.headers[a.toLowerCase()]},g.prototype.handle=function(a){if(a.readyState===2&&h.status2){try{this.statusCode=a.status,this.headers=i(a)}catch(b){h.status2=!1}h.status2&&this.emit("ready")}else if(h.streaming&&a.readyState===3){try{this.statusCode||(this.statusCode=a.status,this.headers=i(a),this.emit("ready"))}catch(b){}try{this.write(a)}catch(b){h.streaming=!1}}else a.readyState===4&&(this.statusCode||(this.statusCode=a.status,this.emit("ready")),this.write(a),a.error?this.emit("error",a.responseText):this.emit("end"))},g.prototype.write=function(a){a.responseText.length>this.offset&&(this.emit("data",a.responseText.slice(this.offset)),this.offset=a.responseText.length)}}),require.alias("http-browserify","/node_modules/http")
=======
var require=function(a,b){var c=require.resolve(a,b||"/"),d=require.modules[c];if(!d)throw new Error("Failed to resolve module "+a+", tried "+c);var e=d._cached?d._cached:d();return e};require.paths=[],require.modules={},require.extensions=[".js",".coffee"],require._core={assert:!0,events:!0,fs:!0,path:!0,vm:!0},require.resolve=function(){return function(a,b){function g(a){if(require.modules[a])return a;for(var b=0;b<require.extensions.length;b++){var c=require.extensions[b];if(require.modules[a+c])return a+c}}function h(a){a=a.replace(/\/+$/,"");var b=a+"/package.json";if(require.modules[b]){var d=require.modules[b](),e=d.browserify;if(typeof e=="object"&&e.main){var f=g(c.resolve(a,e.main));if(f)return f}else if(typeof e=="string"){var f=g(c.resolve(a,e));if(f)return f}else if(d.main){var f=g(c.resolve(a,d.main));if(f)return f}}return g(a+"/index")}function i(a,b){var c=j(b);for(var d=0;d<c.length;d++){var e=c[d],f=g(e+"/"+a);if(f)return f;var i=h(e+"/"+a);if(i)return i}var f=g(a);if(f)return f}function j(a){var b;a==="/"?b=[""]:b=c.normalize(a).split("/");var d=[];for(var e=b.length-1;e>=0;e--){if(b[e]==="node_modules")continue;var f=b.slice(0,e+1).join("/")+"/node_modules";d.push(f)}return d}b||(b="/");if(require._core[a])return a;var c=require.modules.path(),d=b||".";if(a.match(/^(?:\.\.?\/|\/)/)){var e=g(c.resolve(d,a))||h(c.resolve(d,a));if(e)return e}var f=i(a,d);if(f)return f;throw new Error("Cannot find module '"+a+"'")}}(),require.alias=function(a,b){var c=require.modules.path(),d=null;try{d=require.resolve(a+"/package.json","/")}catch(e){d=require.resolve(a,"/")}var f=c.dirname(d),g=(Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b})(require.modules);for(var h=0;h<g.length;h++){var i=g[h];if(i.slice(0,f.length+1)===f+"/"){var j=i.slice(f.length);require.modules[b+j]=require.modules[f+j]}else i===f&&(require.modules[b]=require.modules[f])}},require.define=function(a,b){var c=require._core[a]?"":require.modules.path().dirname(a),d=function(a){return require(a,c)};d.resolve=function(a){return require.resolve(a,c)},d.modules=require.modules,d.define=require.define;var e={exports:{}};require.modules[a]=function(){return require.modules[a]._cached=e.exports,b.call(e.exports,d,e,e.exports,c,a),require.modules[a]._cached=e.exports,e.exports}},typeof process=="undefined"&&(process={}),process.nextTick||(process.nextTick=function(){var a=[],b=typeof window!="undefined"&&window.postMessage&&window.addEventListener;return b&&window.addEventListener("message",function(b){if(b.source===window&&b.data==="browserify-tick"){b.stopPropagation();if(a.length>0){var c=a.shift();c()}}},!0),function(c){b?(a.push(c),window.postMessage("browserify-tick","*")):setTimeout(c,0)}}()),process.title||(process.title="browser"),process.binding||(process.binding=function(a){if(a==="evals")return require("vm");throw new Error("No such module")}),process.cwd||(process.cwd=function(){return"."}),require.define("path",function(a,b,c,d,e){function f(a,b){var c=[];for(var d=0;d<a.length;d++)b(a[d],d,a)&&c.push(a[d]);return c}function g(a,b){var c=0;for(var d=a.length;d>=0;d--){var e=a[d];e=="."?a.splice(d,1):e===".."?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c--;c)a.unshift("..");return a}var h=/^(.+\/(?!$)|\/)?((?:.+?)?(\.[^.]*)?)$/;c.resolve=function(){var a="",b=!1;for(var c=arguments.length;c>=-1&&!b;c--){var d=c>=0?arguments[c]:process.cwd();if(typeof d!="string"||!d)continue;a=d+"/"+a,b=d.charAt(0)==="/"}return a=g(f(a.split("/"),function(a){return!!a}),!b).join("/"),(b?"/":"")+a||"."},c.normalize=function(a){var b=a.charAt(0)==="/",c=a.slice(-1)==="/";return a=g(f(a.split("/"),function(a){return!!a}),!b).join("/"),!a&&!b&&(a="."),a&&c&&(a+="/"),(b?"/":"")+a},c.join=function(){var a=Array.prototype.slice.call(arguments,0);return c.normalize(f(a,function(a,b){return a&&typeof a=="string"}).join("/"))},c.dirname=function(a){var b=h.exec(a)[1]||"",c=!1;return b?b.length===1||c&&b.length<=3&&b.charAt(1)===":"?b:b.substring(0,b.length-1):"."},c.basename=function(a,b){var c=h.exec(a)[2]||"";return b&&c.substr(-1*b.length)===b&&(c=c.substr(0,c.length-b.length)),c},c.extname=function(a){return h.exec(a)[3]||""}}),require.define("/package.json",function(a,b,c,d,e){b.exports={}}),require.define("/spire.io.js",function(a,b,c,d,e){!function(a,c){typeof define=="function"?define(c):typeof b!="undefined"?b.exports=c():this[a]=c()}("spire",function(){var b=function(a,b,c,d){this.name="XHRError",this.message=d||"XHRError",this.xhr=a,this.textStatus=b,this.status=a?a.status||a.statusCode:null};b.prototype=new Error,b.prototype.constructor=b;var c={options:{url:"http://api.spire.io",version:"1.0",timeout:3e4},cache:{},isConnecting:!1,headers:{},messages:{queue:[]},accounts:{},account:{},requests:{description:{},sessions:{},channels:{},subscriptions:{},messages:{},accounts:{},billing:{}}};if(typeof window!="undefined")c.ajax=a("reqwest");else{var d=a("request");c.ajax=function(a){a.headers=a.headers||{},a.method=a.method.toLowerCase();if(a.data)if(a.method==="put"||a.method==="post")typeof a.data=="string"?a.body=a.data:a.body=JSON.stringify(a.data);else{var b=!0;for(var c in a.data)a.url+=b?"?":"&",a.url+=c+"="+a.data[c],b=!1}var e=function(b,c,d){if(b)return a.error(c,c.statusCode,b);if(c.statusCode>=400)return a.error(c,c.statusCode,c.statusCode);a.type==="json"&&(d=JSON.parse(d)),a.success(d)};return a.type==="json"&&(a.headers.Accept||(a.headers.Accept="application/json")),d(a,e)}}return c.headers.authorization=function(a){return["Capability",a.capability].join(" ")},c.headers.mediaType=function(a){return c.schema[c.options.version][a].mediaType},c.messages.subscribe=function(a,b,d){arguments.length===2&&typeof b=="function"&&(d=b,b={}),c.connect(function(e,f){if(e)return d(e);var g={session:f,name:a},h=0,i=function(a){h++;if(b.maxCallCount<h)return;for(var e in b)a[e]=b[e];c.requests.subscriptions.get(a,function(b,c){if(b)return d(b);c.messages.length>0&&d(null,c.messages),i(a)})};c.requests.channels.create(g,function(b,e){if(b)return b.status===409?c.requests.sessions.get(f,function(b,e){b&&d(b);var f=e.resources.channels.resources[a];c.requests.channels.get(f,function(a,b){var f={channels:[b],events:["messages"],session:e};c.requests.subscriptions.create(f,function(a,b){if(a)return d(a);var c={subscription:b};i(c)})})}):d(b);var g={channels:[e],events:["messages"],session:f};c.requests.subscriptions.create(g,function(a,b){if(a)return d(a);var c={subscription:b};i(c)})})})},c.messages.publish=function(a,b){if(c.isConnecting){c.messages.queue.push({message:a,callback:b});return}c.connect(function(d,e){if(d)return b(d);var f={session:e,name:a.channel};c.requests.channels.create(f,function(d,f){var g={session:e,name:a.channel};if(d)return d.status===409?c.requests.sessions.get(e,function(d,e){if(d){if(b)return b(d,null);throw d}var f=e.resources.channels.resources[a.channel];c.requests.channels.get(f,function(d,e){var f={channel:e,content:a.content};c.requests.messages.create(f,function(a,c){if(a)return b(a);b&&b(null,c)})})}):b(d,null);var g={channel:f,content:a.content};c.requests.messages.create(g,function(a,c){if(a)return b(a);b&&b(null,c)})})})},c.accounts.create=function(a,b){c.requests.description.get(function(d,e){if(d)return b(d);c.requests.accounts.create(a,b)})},c.accounts.update=function(a,b){c.requests.description.get(function(d,e){if(d)return b(d);c.requests.accounts.update(a,b)})},c.accounts.authenticate=function(a,b){c.requests.description.get(function(d,e){if(d)return b(d);var f={key:c.options.key,email:a.email,password:a.password};c.requests.sessions.create(f,b)})},c.connect=function(a){c.isConnecting=!0,c.requests.description.get(function(b,d){if(b)return a(b);var e={key:c.options.key},f=function(b,d){if(b)return a(b);c.isConnecting=!1,c.session=d;if(c.messages.queue.length>0){var e;while(e=c.messages.queue.pop())e&&c.messages.publish(e.message,e.callback)}return a(null,d)};c.session?f(null,c.session):c.requests.sessions.create(e,f)})},c.requests.description.get=function(a){if(c.resources){var d={resources:c.resources,schema:c.schema};return a(null,d)}c.ajax({method:"GET",url:c.options.url,type:"json",error:function(c,d,e){var f=new b(c,d,e);a(f)},success:function(b,d,e){c.resources=b.resources,c.schema=b.schema,a(null,b)}})},c.requests.sessions.get=function(a,d){c.ajax({method:"get",url:a.url,headers:{Accept:c.headers.mediaType("session"),Authorization:c.headers.authorization(a)},type:"json",error:function(a,c,e){var f=new b(a,c,e);d(f)},success:function(a,b,c){d(null,a)}})},c.requests.sessions.create=function(a,d){if(!a.key&&typeof a.email!="string"&&typeof a.password!="string"){var e=["You need a key to do that! Try doing this:","   spire.options.key = <your account key>"].join("\n");throw new Error(e)}a.email&&a.password&&(a.key=null),c.ajax({method:"post",url:c.resources.sessions.url,headers:{"Content-Type":c.headers.mediaType("account"),Accept:c.headers.mediaType("session")},data:JSON.stringify(a),type:"json",error:function(a,c,e){var f=new b(a,c,e);d(f)},success:function(a,b,c){d(null,a)}})},c.requests.channels.get=function(a,d){c.ajax({method:"get",url:a.url,headers:{Accept:c.headers.mediaType("channel"),Authorization:c.headers.authorization(a)},type:"json",error:function(a,c,e){var f=new b(a,c,e);d(f,null)},success:function(a,b,c){d(null,a)}})},c.requests.channels.create=function(a,d){var e=a.session.resources.channels,f=a.name;c.ajax({method:"post",url:e.url,headers:{"Content-Type":c.headers.mediaType("channel"),Accept:c.headers.mediaType("channel"),Authorization:c.headers.authorization(e)},data:JSON.stringify({name:f}),type:"json",error:function(a,c,e){var f=new b(a,c,e);d(f)},success:function(a,b,c){d(null,a)}})},c.requests.subscriptions.create=function(a,d){var e=a.session.resources.subscriptions,f={events:a.events,channels:[]};for(var g=0;g<a.channels.length;g++)f.channels.push(a.channels[g].url);c.ajax({method:"post",url:e.url,headers:{"Content-Type":c.headers.mediaType("subscription"),Accept:c.headers.mediaType("subscription"),Authorization:c.headers.authorization(e)},data:JSON.stringify(f),type:"json",error:function(a,c,e){var f=new b(a,c,e);d(f)},success:function(a,b,c){d(null,a)}})},c.requests.subscriptions.get=function(a,d){var e=a.subscription;data={timeout:a.timeout||c.options.timeout/1e3},e["last-message"]&&(data["last-message"]=e["last-message"]),c.ajax({method:"get",url:e.url,headers:{"Content-Type":c.headers.mediaType("events"),Accept:c.headers.mediaType("events"),Authorization:c.headers.authorization(e)},data:data,type:"json",error:function(a,c,e){if(e==="timeout")d(null,{messages:[]});else{var f=new b(a,c,e);d(f)}},success:function(a,b,c){var f=a.messages.length;f>0&&(e["last-message"]=a.messages[f-1].timestamp),d(null,a)}})},c.requests.messages.create=function(a,d){var e=a.channel,f=a.content;c.ajax({method:"post",url:e.url,headers:{"Content-Type":c.headers.mediaType("message"),Accept:c.headers.mediaType("message"),Authorization:c.headers.authorization(e)},data:JSON.stringify({content:f}),type:"json",error:function(a,c,e){var f=new b(a,c,e);d(f)},success:function(a,b,c){d(null,a)}})},c.requests.accounts.create=function(a,d){c.ajax({method:"post",url:c.resources.accounts.url,headers:{"Content-Type":c.headers.mediaType("account"),Accept:c.headers.mediaType("session")},data:JSON.stringify(a),type:"json",success:function(a,b,c){d(null,a)},error:function(a,c,e){var f=new b(a,c,e);d(f)}})},c.requests.accounts.update=function(a,d){c.ajax({method:"put",url:a.url,headers:{"Content-Type":c.headers.mediaType("account"),Accept:c.headers.mediaType("account"),Authorization:c.headers.authorization(a)},data:JSON.stringify(a),type:"json",success:function(a,b,c){d(null,a)},error:function(a,c,e){var f=new b(a,c,e);d(f)}})},c.requests.accounts.reset=function(a,d){c.ajax({method:"post",url:a.url,headers:{"Content-Type":c.headers.mediaType("account"),Accept:c.headers.mediaType("account"),Authorization:c.headers.authorization(a)},type:"json",success:function(a,b,c){d(null,a)},error:function(a,c,e){var f=new b(a,c,e);d(f)}})},c.requests.billing.get=function(a){c.ajax({method:"GET",url:c.resources.billing.url,headers:{"Content-Type":c.headers.mediaType("billing"),Accept:c.headers.mediaType("billing")},type:"json",error:function(c,d,e){var f=new b(c,d,e);a(f)},success:function(b,c,d){a(null,b)}})},c})}),require.define("/node_modules/reqwest/package.json",function(a,b,c,d,e){b.exports={main:"./reqwest.js"}}),require.define("/node_modules/reqwest/reqwest.js",function(require,module,exports,__dirname,__filename){!function(a,b){typeof define=="function"?define(b):typeof module!="undefined"?module.exports=b():this[a]=b()}("reqwest",function(){function handleReadyState(a,b,c){return function(){a&&a[readyState]==4&&(twoHundo.test(a.status)?b(a):c(a))}}function setHeaders(a,b){var c=b.headers||{};c.Accept=c.Accept||defaultHeaders.accept[b.type]||defaultHeaders.accept["*"],!b.crossOrigin&&!c[requestedWith]&&(c[requestedWith]=defaultHeaders.requestedWith),c[contentType]||(c[contentType]=b.contentType||defaultHeaders.contentType);for(var d in c)c.hasOwnProperty(d)&&a.setRequestHeader(d,c[d])}function generalCallback(a){lastValue=a}function urlappend(a,b){return a+(/\?/.test(a)?"&":"?")+b}function handleJsonp(a,b,c,d){var e=uniqid++,f=a.jsonpCallback||"callback",g=a.jsonpCallbackName||"reqwest_"+e,h=new RegExp("("+f+")=(.+)(&|$)"),i=d.match(h),j=doc.createElement("script"),k=0;i?i[2]==="?"?d=d.replace(h,"$1="+g+"$3"):g=i[2]:d=urlappend(d,f+"="+g),win[g]=generalCallback,j.type="text/javascript",j.src=d,j.async=!0,typeof j.onreadystatechange!="undefined"&&(j.event="onclick",j.htmlFor=j.id="_reqwest_"+e),j.onload=j.onreadystatechange=function(){if(j[readyState]&&j[readyState]!=="complete"&&j[readyState]!=="loaded"||k)return!1;j.onload=j.onreadystatechange=null,j.onclick&&j.onclick(),a.success&&a.success(lastValue),lastValue=undefined,head.removeChild(j),k=1},head.appendChild(j)}function getRequest(a,b,c){var d=(a.method||"GET").toUpperCase(),e=typeof a=="string"?a:a.url,f=a.processData!==!1&&a.data&&typeof a.data!="string"?reqwest.toQueryString(a.data):a.data||null;(a.type=="jsonp"||d=="GET")&&f&&(e=urlappend(e,f))&&(f=null);if(a.type=="jsonp")return handleJsonp(a,b,c,e);var g=xhr();return g.open(d,e,!0),setHeaders(g,a),g.onreadystatechange=handleReadyState(g,b,c),a.before&&a.before(g),g.send(f),g}function Reqwest(a,b){this.o=a,this.fn=b,init.apply(this,arguments)}function setType(a){var b=a.match(/\.(json|jsonp|html|xml)(\?|$)/);return b?b[1]:"js"}function init(o,fn){function complete(a){o.timeout&&clearTimeout(self.timeout),self.timeout=null,o.complete&&o.complete(a)}function success(resp){var r=resp.responseText;if(r)switch(type){case"json":try{resp=win.JSON?win.JSON.parse(r):eval("("+r+")")}catch(err){return error(resp,"Could not parse JSON in response",err)}break;case"js":resp=eval(r);break;case"html":resp=r}fn(resp),o.success&&o.success(resp),complete(resp)}function error(a,b,c){o.error&&o.error(a,b,c),complete(a)}this.url=typeof o=="string"?o:o.url,this.timeout=null;var type=o.type||setType(this.url),self=this;fn=fn||function(){},o.timeout&&(this.timeout=setTimeout(function(){self.abort()},o.timeout)),this.request=getRequest(o,success,error)}function reqwest(a,b){return new Reqwest(a,b)}function normalize(a){return a?a.replace(/\r?\n/g,"\r\n"):""}function serial(a,b){var c=a.name,d=a.tagName.toLowerCase(),e=function(a){a&&!a.disabled&&b(c,normalize(a.attributes.value&&a.attributes.value.specified?a.value:a.text))};if(a.disabled||!c)return;switch(d){case"input":if(!/reset|button|image|file/i.test(a.type)){var f=/checkbox/i.test(a.type),g=/radio/i.test(a.type),h=a.value;(!f&&!g||a.checked)&&b(c,normalize(f&&h===""?"on":h))}break;case"textarea":b(c,normalize(a.value));break;case"select":if(a.type.toLowerCase()==="select-one")e(a.selectedIndex>=0?a.options[a.selectedIndex]:null);else for(var i=0;a.length&&i<a.length;i++)a.options[i].selected&&e(a.options[i])}}function eachFormElement(){var a=this,b,c,d,e=function(b,c){for(var e=0;e<c.length;e++){var f=b[byTag](c[e]);for(d=0;d<f.length;d++)serial(f[d],a)}};for(c=0;c<arguments.length;c++)b=arguments[c],/input|select|textarea/i.test(b.tagName)&&serial(b,a),e(b,["input","select","textarea"])}function serializeQueryString(){return reqwest.toQueryString(reqwest.serializeArray.apply(null,arguments))}function serializeHash(){var a={};return eachFormElement.apply(function(b,c){b in a?(a[b]&&!isArray(a[b])&&(a[b]=[a[b]]),a[b].push(c)):a[b]=c},arguments),a}var context=this,win=window,doc=document,old=context.reqwest,twoHundo=/^20\d$/,byTag="getElementsByTagName",readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",head=doc[byTag]("head")[0],uniqid=0,lastValue,xmlHttpRequest="XMLHttpRequest",defaultHeaders={contentType:"application/x-www-form-urlencoded",accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"},requestedWith:xmlHttpRequest},xhr=xmlHttpRequest in win?function(){return new XMLHttpRequest}:function(){return new ActiveXObject("Microsoft.XMLHTTP")};Reqwest.prototype={abort:function(){this.request.abort()},retry:function(){init.call(this,this.o,this.fn)}};var isArray=typeof Array.isArray=="function"?Array.isArray:function(a){return a instanceof Array};return reqwest.serializeArray=function(){var a=[];return eachFormElement.apply(function(b,c){a.push({name:b,value:c})},arguments),a},reqwest.serialize=function(){if(arguments.length===0)return"";var a,b,c=Array.prototype.slice.call(arguments,0);return a=c.pop(),a&&a.nodeType&&c.push(a)&&(a=null),a&&(a=a.type),a=="map"?b=serializeHash:a=="array"?b=reqwest.serializeArray:b=serializeQueryString,b.apply(null,c)},reqwest.toQueryString=function(a){var b="",c,d=encodeURIComponent,e=function(a,c){b+=d(a)+"="+d(c)+"&"};if(isArray(a))for(c=0;a&&c<a.length;c++)e(a[c].name,a[c].value);else for(var f in a){if(!Object.hasOwnProperty.call(a,f))continue;var g=a[f];if(isArray(g))for(c=0;c<g.length;c++)e(f,g[c]);else e(f,a[f])}return b.replace(/&$/,"").replace(/%20/g,"+")},reqwest.compat=function(a,b){return a&&(a.type&&(a.method=a.type)&&delete a.type,a.dataType&&(a.type=a.dataType),a.jsonpCallback&&(a.jsonpCallbackName=a.jsonpCallback)&&delete a.jsonpCallback,a.jsonp&&(a.jsonpCallback=a.jsonp)),new Reqwest(a,b)},reqwest.noConflict=function(){return context.reqwest=old,this},reqwest})})
>>>>>>> d61ff47c11eba26f04f3b078465bf42d78be3995
